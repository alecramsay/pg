---
layout: page

small-radar-width: 300
big-radar-width: 500
map-width: 700
---

<!-- SUMMARY ANALYSIS -->

{{ content }}

{% assign xx = page.xx %}

<!-- BASELINE DISTRICTS -->

{% capture baseline-png %}
{{ site.baseurl }}/assets/images/{{ xx }}_2022_Congress_Baseline_map.png
{% endcapture %}
{% assign baseline-png = baseline-png | strip_newlines %}

{% assign state = site.data.states | where:"xx", xx | first %}

{% capture baseline-link %}
https://davesredistricting.org/join/{{ state["baseline"] }}
{% endcapture %}
{% assign baseline-link = baseline-link | strip_newlines %}

<h3>Baseline Districts</h3>

<p>These are the baseline congressional districts:</p>
<p style="text-align: left">
    <a href="{{ baseline-link }}">
        <img src="{{ baseline-png }}" alt="Baseline districts" title="Click to view the map in Dave's Redistricting"
            width="{{ page.map-width }}" />
    </a>
</p>

<h3>Ratings vs. Baseline</h3>

<!-- RADAR DIAGRAMS -->

<p>These radar diagrams compare the ratings of official map and the five notable maps with the baseline map:</p>

<table style="border:0px">
    <tr>
        <td style="border:0px">
            <img src="{{ site.baseurl }}/assets/images/{{ xx }}_2022_Congress_Official_radar.png"
                alt="{{ site.data.maps[0].label }}" title="{{ site.data.maps[0].label }}"
                width="{{ page.small-radar-width }}" />
        </td>
        <td style="border:0px">
            <img src="{{ site.baseurl }}/assets/images/{{ xx }}_2022_Congress_Proportional_radar.png"
                alt="{{ site.data.maps[1].qualified-label }}" title="{{ site.data.maps[1].qualified-label }}"
                width="{{ page.small-radar-width }}" />
        </td>
        <td style="border:0px">
            <img src="{{ site.baseurl }}/assets/images/{{ xx }}_2022_Congress_Competitive_radar.png"
                alt="{{ site.data.maps[2].qualified-label }}" title="{{ site.data.maps[2].qualified-label }}"
                width="{{ page.small-radar-width }}" />
        </td>
    </tr>
    <tr>
        <td style="border:0px">
            <img src="{{ site.baseurl }}/assets/images/{{ xx }}_2022_Congress_Minority_radar.png"
                alt="{{ site.data.maps[3].qualified-label }}" title="{{ site.data.maps[3].qualified-label }}"
                width="{{ page.small-radar-width }}" />
        </td>
        <td style="border:0px">
            <img src="{{ site.baseurl }}/assets/images/{{ xx }}_2022_Congress_Compact_radar.png"
                alt="{{ site.data.maps[4].qualified-label }}" title="{{ site.data.maps[4].qualified-label }}"
                width="{{ page.small-radar-width }}" />
        </td>
        <td style="border:0px">
            <img src="{{ site.baseurl }}/assets/images/{{ xx }}_2022_Congress_Splitting_radar.png"
                alt="{{ site.data.maps[3].qualified-label }}" title="{{ site.data.maps[3].qualified-label }}"
                width="{{ page.small-radar-width }}" />
        </td>
    </tr>
</table>

<!-- RATINGS TABLE -->

{% capture ratings-file %}
{{ xx }}_2022_Congress_ratings
{% endcapture %}
{% assign ratings-file = ratings-file | strip_newlines %}

{% assign ratings = site.data[ratings-file] %}

<style>
    #ratings-table {
        width: 800px;
    }

    .bold-row {
        font-weight: bold;
    }

    #official-cores-table {
        width: 300px;
    }

    #proportional-cores-table {
        width: 300px;
    }

    #competitive-cores-table {
        width: 300px;
    }

    #minority-cores-table {
        width: 300px;
    }

    #compact-cores-table {
        width: 300px;
    }

    #splitting-cores-table {
        width: 300px;
    }

    .ag-header-cell.text-center {
        .ag-header-cell-label {
            justify-content: center;
        }
    }

    .ag-header-cell.text-right {
        .ag-header-cell-label {
            justify-content: right;
        }
    }

    /* TODO */
    /* .ag-theme-balham {
        --ag-font-family: monospace;
    } */
</style>

<div id="ratings-table" class="ag-theme-balham">
</div>

<!-- Common grid functionality -->
<script src="{{ site.baseurl }}/assets/js/grid.js"></script>

<!-- Grid -->
<script type="text/javascript" charset="utf-8">
    const ratingsColumns = [
        {field: 'Map', unSortIcon: true},
        {field: 'Proportionality', comparator: numericComparator, sortingOrder: ['desc', 'asc'], ...centeredColumn},
        {field: 'Competitiveness', comparator: numericComparator, sortingOrder: ['desc', 'asc'], ...centeredColumn},
        {field: 'Minority', comparator: numericComparator, sortingOrder: ['desc', 'asc'], ...centeredColumn},
        {field: 'Compactness', comparator: numericComparator, sortingOrder: ['desc', 'asc'], ...centeredColumn},
        {field: 'Splitting', comparator: numericComparator, sortingOrder: ['desc', 'asc'], ...centeredColumn},
    ];

    const ratingsOptions = {
        defaultColDef: {
            sortable: true,
            // resizable: true,
        },
        rowClassRules: {
            'bold-row': function (params) {return params.data.Map === "Official" || params.data.Map === "Baseline";},
        },
        columnDefs: ratingsColumns,
        domLayout: 'autoHeight',
        onGridReady: (event) => {renderRatingsTable(event.api)}
    };

    const eRatingsGridDiv = document.getElementById('ratings-table');
    new agGrid.Grid(eRatingsGridDiv, ratingsOptions);

    const ratingsCSV = 'https://raw.githubusercontent.com/alecramsay/pg/main/docs/_data/{{ ratings-file }}.csv';
    // const ratingsCSV = 'https://raw.githubusercontent.com/alecramsay/pg/main/docs/_data/NC_2022_Congress_ratings.csv';

    function renderRatingsTable(api)
    {
        Papa.parse(ratingsCSV, {
            header: true,
            download: true,
            complete: response =>
            {
                data = response.data;
                data.pop();
                // console.log("Finished:", data);

                api.setRowData(data);
                api.sizeColumnsToFit();
            }
        })
    }

</script>

<!-- MAPS TABS -->

<h3>Districts vs. Baseline</h3>

<p>These tabs compare the district boundaries of official map and the five notable maps with the baseline map:</p>

<script src="{{ site.baseurl }}/assets/js/tabs.js"></script>

<!-- Tab links -->
<div class="tab">
    <button class="tablinks" onclick="openTab(event, '{{ site.data.maps[0].label }}')" id="defaultOpen">{{
        site.data.maps[0].qualified-label }}</button>
    <button class="tablinks" onclick="openTab(event, '{{ site.data.maps[1].label }}')">{{
        site.data.maps[1].qualified-label
        }}</button>
    <button class="tablinks" onclick="openTab(event, '{{ site.data.maps[2].label }}')">{{
        site.data.maps[2].qualified-label
        }}</button>
    <button class="tablinks" onclick="openTab(event, '{{ site.data.maps[3].label }}')">{{
        site.data.maps[3].qualified-label
        }}</button>
    <button class="tablinks" onclick="openTab(event, '{{ site.data.maps[4].label }}')">{{
        site.data.maps[4].qualified-label
        }}</button>
    <button class="tablinks" onclick="openTab(event, '{{ site.data.maps[5].label }}')">{{
        site.data.maps[5].qualified-label
        }}</button>
</div>

<!-- Tab content -->

<!-- Official -->
{% include test.html index=0 %}

<!-- Most Proportional -->
{% include test.html index=1 %}

<!-- Most Competitive -->
{% include test.html index=2 %}

<!-- Best Minority -->
{% include test.html index=3 %}

<!-- Most Compact -->
{% include test.html index=4 %}

<!-- Least Splitting -->
{% include test.html index=5 %}

<!-- Show the Official tab by default -->
<script>
    // Get the element with id="defaultOpen" and click on it
    document.getElementById("defaultOpen").click();
</script>